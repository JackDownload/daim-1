language: node_js
#  latest stable Node.js release
node_js: lts/*
addons:
  chrome: stable # make Chrome available
# Cache node packages between jobs
cache: npm

script:
  - npm run lint
  # - npm run test
  - npm run build:export
  - npx semantic-release

deploy:
  - provider: surge
    domain: daim.dev
    project: ./dist
    # edge: true # opt in to dpl v2
    skip_cleanup: true
    on:
      branch: master

  - provider: surge
    domain: staging.daim.dev
    project: ./dist
    # edge: true # opt in to dpl v2
    skip_cleanup: true
    on:
      all_branches: true

  - provider: firebase
    skip_cleanup: true
    project: default
    token:
      secure: I4y3a/ZdF0RD2XekLn92W66lta+1EULrlZnUUGge4Xv/LTXBzMn34QAwCtekjEOIgTD+ENemN1Ct5Z9Q6VvaBqi5jb2aeL6CIZcFfUIoAmh1a/7V0oHgJqXGTS8L0kxzOurJr61GgywpUr5ISFFrZ2R7wKQGrTNPWn3Oq+PbTRg2aWlGj5s06nZ0y6NT1FdZ60FL/QeVQSIFoQuv7Oa6wdfhWRJ1yaDGVzw1Fqa6pqOCUVeB+XlckGb2p0BI4Uw0/YHQwDnwd5+9XdKHRbBsf1KqjuYQjrFk42o6/t0GZHREvsw4wmkrVTnC2+ObCXY4Z3JLZ8L1wGZuFqVcwe5JJJ1V6lS3nPpi46yJCGYR+C4skqSUmbjWCVYySbNYBtiuFUKQmp/eEaWNFCehH0xy8wU3NZaspf1HGlOhFTih/JTnLJ54kIpe90iHcnF+7NwMa2w45ZJyTSte4mBdXdRxCLyd1n28SFz866jy3IIf9AJIhz7QGNhgPu/0NlDFCqPHl/lJY2TwmqjIU3VlZmhVfhBMUbFVu3QCIAn32492eQjvUrWyTeSeoP+2HN+gZnpxvmWybqszN2vTej4OIFoqFFCsNbvTxZMdQkyhAhqpF1IuIhunxPmINHQRKRG0Ndn1OH580/OAq94pA0/ZJx2j5VHcwHmBA2dgtrbGME/TGmw=
    on:
      branch: master

after_success:
  - npm run lhci:autorun
